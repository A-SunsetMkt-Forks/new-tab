<div id="a">
  <div id="b">
    {#each __bookmarksBar as __bookmark}
      <BookmarkItem __input="{__bookmark}" lvl="{0}"/>
    {/each}
  </div>

  <BookmarkItem __input="{__bookmarksOther}" lvl="{0}" left/>
</div>

<script>
  import { chromeLink } from '../helpers';
  import BookmarkItem from './BookmarkItem.html';

  export default {
    components: {
      BookmarkItem,
    },
    data: () => ({
      __bookmarksOther: { title: 'Other bookmarks' },
      __bookmarksBar: [],
    }),
    oncreate() {
      chrome.bookmarks.getTree((tree) => {
        this.set({
          __bookmarksBar: tree[0].children[0].children,
          __bookmarksOther: tree[0].children[1],
        });
      });
    },
    methods: {
      __link: chromeLink,
    },
  };
</script>

<style>
  :global(.i),
  :global(.t) {
    pointer-events: none; /* prevent being the MouseEvent target */
  }

  :global(.i) { /* favicon */
    width: 16px;
    height: auto; /* hides broken img when src is missing */
  }

  :global(.t) { /* bookmark title */
    max-width: 15ch;
    padding-left: 9px;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  :global(.b) { /* bookmark item */
    display: inline-flex;
    align-items: center;
    padding: 9px 7px;
    color: var(--t);
    text-decoration: none;
    white-space: nowrap;

    &:hover {
      background-color: var(--c);
    }
  }

  :global(#b) { /* bookmarks bar */
    display: flex;
    align-items: center;
    max-width: 100%;
    margin-right: auto;
    overflow: hidden; /* FIXME: Breaks subfolders; only a temporary workaround */
  }

  :global(#a) { /* all bookmarks */
    position: fixed;
    top: 0;
    right: 0;
    left: 0;
    z-index: 2;
    display: flex;
    min-height: 41px;
    padding: 0 7px;
    background: var(--c1);
    filter: drop-shadow(0 9px 9px var(--s));

    &:last-child { /* "other bookmarks" folder */
      margin-left: auto;
    }
  }
</style>
