<div class="pb">
  <label for="theme">Theme</label>
  <select id="theme" bind:value="__theme">
    <option value="light">Light</option>
    <option value="{null}">Dark</option>
  </select>
</div>

<hr>

<div class="pb">
  <label for="opt-out">
    <input id="opt-out" bind:checked="__errTrack" type="checkbox" class="checkbox">
    Allow error tracking
  </label>
</div>

<footer>
  <small>
    <em>Tip: Settings sync to your account.</em>
  </small>
</footer>

<script>
  export default {
    data: () => ({
      /** @type {string} */
      __theme: null, // frontend theme
      /** @type {Boolean} */
      __errTrack: true, // error tracking opt-out
    }),
    oncreate() {
      // check existing settings
      chrome.storage.sync.get(null, (settings) => {
        this.set({
          __theme: settings.t || null,
          __errTrack: !settings.e,
        });
      });
    },
    onstate({ changed, current, previous }) {
      if (previous) {
        if (changed.__theme) {
          chrome.storage.sync.set({ t: current.__theme, td: Date.now() });
        }

        if (changed.__errTrack) {
          chrome.storage.sync.set({ e: !current.__errTrack, ed: Date.now() });
        }
      }
    },
  };
</script>

<style type="text/postcss" global>
  body {
    font-size: 18px;
    text-rendering: optimizeLegibility;
    background: rgb(249, 249, 249);
  }

  hr {
    border: 0;
    border-bottom: 1px solid rgb(221, 221, 221);
  }

  footer {
    margin-top: 18px;
  }

  select {
    margin-left: 9px;
  }

  hr,
  .pb {
    margin-bottom: 18px;
  }

  .checkbox {
    margin-right: 9px;
    vertical-align: 0;
  }
</style>
