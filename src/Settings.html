<div class="pb">
  <label for="theme">Theme</label>
  <select id="theme" bind:value="__theme">
    <option value="l">Light</option>
    <option value="d">Dark</option>
    <option value="b">Black</option>
  </select>
</div>

<hr>

<div class="pb">
  <label for="opt-out">
    <input id="opt-out" bind:checked="__errDetect" type="checkbox">
    Allow error detection
  </label>
</div>

<footer>
  <small>
    <em>Tip: Settings sync to your account.</em>
  </small>
</footer>

<script>
  export default {
    data: () => ({
      __theme: 'd', // frontend theme
      __errDetect: true, // error detection opt-out
    }),
    oncreate() {
      // check existing settings
      chrome.storage.sync.get(null, (settings) => {
        this.set({
          __theme: settings.t || 'd',
          __errDetect: !settings.e,
        });
      });
    },
    onstate({ changed, current, previous }) {
      if (previous) {
        if (changed.__theme) {
          console.log('__changeTheme', current.__theme);
          chrome.storage.sync.set({ t: current.__theme, td: Date.now() });
        }

        if (changed.__errDetect) {
          console.log('__changeOptOut', current.__errDetect);
          chrome.storage.sync.set({ e: !current.__errDetect, ed: Date.now() });
        }
      }
    },
  };
</script>

<style type="text/postcss">
  :global(body) {
    font-size: 18px;
    text-rendering: optimizeLegibility;
    background: hsl(0, 0%, 98%);
  }

  :global(hr) {
    border: 0;
    border-bottom: 1px solid hsl(0, 0%, 87%);
  }

  :global(footer) {
    margin-top: 18px;
  }

  :global(select) {
    margin-left: 9px;
  }

  :global(hr),
  :global(.pb) {
    margin-bottom: 18px;
  }

  :global(input[type="checkbox"]) {
    margin-right: 9px;
    vertical-align: 0;
  }
</style>
